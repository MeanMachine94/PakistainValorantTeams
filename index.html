<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Team and Player Filter</title>
    <style>
        .card {
            height: 280px;
            width: 400px;
        }
        .card-img-top {
            height: 225px;
            width: 400px;
            object-fit: cover;
        }
        .team-logo {
            height: 40px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container mt-5 text-center">
        <h1>Pakistain Valorant Teams And There Players</h1>
        <input type="text" id="filterInput" class="form-control" placeholder="Filter by player name or team name">
        <div class="accordion mt-5" id="teamAccordion"></div>
    </div>

    <script>
        async function fetchTeams() {
            const response = await fetch('teams.json');
            return response.json();
        }

        async function fetchPlayerImages() {
            const response = await fetch('players.json');
            return response.json();
        }

        function displayTeams(teams, playerImages) {
            const accordion = document.getElementById('teamAccordion');
            accordion.innerHTML = '';

            teams.forEach((team) => {
                const teamId = team.team.replace(/[^a-zA-Z0-9_]+/g, '_');
                const teamCard = document.createElement('div');
                teamCard.classList.add('accordion-item');

                const header = document.createElement('h2');
                header.classList.add('accordion-header');
                header.id = `heading_${teamId}`;

                const button = document.createElement('button');
                button.classList.add('accordion-button');
                button.type = 'button';
                button.setAttribute('data-bs-toggle', 'collapse');
                button.setAttribute('data-bs-target', `#collapse_${teamId}`);
                button.setAttribute('aria-expanded', 'true');
                button.setAttribute('aria-controls', `collapse_${teamId}`);

                // Create team logo element
                const logo = document.createElement('img');
                logo.src = team.logo;
                logo.alt = team.team + ' Logo';
                logo.classList.add('team-logo');

                button.appendChild(logo); // Add logo to button
                button.appendChild(document.createTextNode(team.team)); // Add team name

                header.appendChild(button);
                teamCard.appendChild(header);

                const body = document.createElement('div');
                body.id = `collapse_${teamId}`;
                body.classList.add('accordion-collapse', 'collapse', 'hide');
                body.setAttribute('aria-labelledby', `heading_${teamId}`);
                body.setAttribute('data-bs-parent', '#teamAccordion');

                // Create a div for the created date
                const createdDate = document.createElement('p');
                createdDate.classList.add('mt-2', 'text-muted');
                createdDate.innerText = `Added on: ${team.createdat}, Last updated at: ${team.updatedat}`;

                const playerList = document.createElement('div');
                playerList.classList.add('row', 'mt-3', 'mx-auto');

                team.players.forEach(player => {
                    const cardCol = document.createElement('div');
                    cardCol.classList.add('col-4', 'mb-3');

                    const card = document.createElement('div');
                    card.classList.add('card');

                    const playerImage = document.createElement('img');
                    playerImage.src = playerImages[player.toLowerCase()] || 'https://cdn.discordapp.com/attachments/1288166821605675102/1288173264803467407/g3.png?ex=66f43857&is=66f2e6d7&hm=31785629ccb54cf6f5a155a2ff873c6961a505ec59b70bc50aa0ec08ab5c2c7e&';
                    playerImage.alt = player;
                    playerImage.classList.add('card-img-top');

                    const cardBody = document.createElement('div');
                    cardBody.classList.add('card-body');

                    const playerName = document.createElement('h6');
                    playerName.classList.add('card-title');
                    playerName.innerText = player;

                    cardBody.appendChild(playerName);
                    card.appendChild(playerImage);
                    card.appendChild(cardBody);
                    cardCol.appendChild(card);
                    playerList.appendChild(cardCol);
                });

                body.appendChild(createdDate); // Append created date
                body.appendChild(playerList);
                teamCard.appendChild(body);
                accordion.appendChild(teamCard);
            });

            // Check for URL hash and open the corresponding accordion
            const hash = window.location.hash;
            if (hash) {
                const target = document.querySelector(hash);
                if (target) {
                    const accordionCollapse = new bootstrap.Collapse(target, {
                        toggle: true
                    });
                }
            }
        }

        function filterTeams(teams, playerImages) {
            const input = document.getElementById('filterInput').value.toLowerCase();
            const filteredTeams = teams.filter(team =>
                team.team.toLowerCase().includes(input) ||
                team.players.some(player => player.toLowerCase().includes(input))
            );
            displayTeams(filteredTeams, playerImages);
        }

        Promise.all([fetchTeams(), fetchPlayerImages()]).then(([teams, playerImages]) => {
            displayTeams(teams, playerImages);
            document.getElementById('filterInput').addEventListener('input', () => {
                filterTeams(teams, playerImages);
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>